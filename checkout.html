
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js"> <!--<![endif]-->
<head>
	<style>
        table{
            border-collapse: collapse;
            text-align: center;
		}
		#subtotal{
			margin-left: 90px;
		}
    </style>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="description" content="An ecommerce page for the night market">
	<meta name="author" content="UCCD2223 students">

	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://www.paypalobjects.com/api/checkout.js"></script>
  
	<title>TOY CITY | Checkout</title>
  
	<!-- Mobile Specific Meta-->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- Favicon -->
	<link rel="shortcut icon" type="image/x-icon" href="images/favicon1.jpg" />
	
	<!-- Themefisher Icon font -->
	<link rel="stylesheet" href="plugins/themefisher-font/style.css">
	<!-- bootstrap.min css -->
	<link rel="stylesheet" href="plugins/bootstrap/css/bootstrap.min.css">
	
	<!-- Revolution Slider -->
	<link rel="stylesheet" type="text/css" href="plugins/revolution-slider/revolution/fonts/pe-icon-7-stroke/css/pe-icon-7-stroke.css">
	<link rel="stylesheet" type="text/css" href="plugins/revolution-slider/revolution/fonts/font-awesome/css/font-awesome.css">
  
	<!-- REVOLUTION STYLE SHEETS -->
	<link rel="stylesheet" type="text/css" href="plugins/revolution-slider/revolution/css/settings.css">
	<link rel="stylesheet" type="text/css" href="plugins/revolution-slider/revolution/css/layers.css">
	<link rel="stylesheet" type="text/css" href="plugins/revolution-slider/revolution/css/navigation.css">
	
	<!-- Main Stylesheet -->
	<link rel="stylesheet" href="css/style.css">
  
  </head>
  
  <body id="body">
  
  <!-- Start Top Header Bar -->
  <section class="top-header">
	  <div class="container">
		  <div class="row">
			  <div class="col-md-4 col-xs-12 col-sm-4">
				  <div class="contact-number">
					  <i class="tf-ion-ios-telephone"></i>
					  <span>011-11113456</span>
				  </div>
			  </div>
			  <div class="col-md-4 col-xs-12 col-sm-4">
				  <!-- Site Logo -->
				  <div class="logo text-center">
					  <a href="index.html">
						  <!-- replace logo here -->
						  <img  class="media-object" src="images/logo.jpg" height=180 alt="image" />
						  <svg width="300px" height="29px" viewBox="0 0 155 29" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
							  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-size="40" font-family="AustinBold, Austin" font-weight="bold">
								  <g id="Group" transform="translate(-108.000000, -297.000000)" fill="#000000">
									  <text id="ToyCity">
										  <tspan x="60" y="325">TOY CITY</tspan>
									  </text>
								  </g>
							  </g>
						  </svg>
						   
					  </a>
				  </div>
			  </div>
			  <div class="col-md-4 col-xs-12 col-sm-4">
			  <!-- Cart -->
			  <ul class="top-menu text-right list-inline">
				<li class="dropdown ">
				  <a href="cart.html" ><i class="tf-ion-android-cart"></i>Cart</a>
				</li><!-- / Cart -->
  
				<!-- Search -->
				<li class="dropdown search dropdown-slide">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown"><i class="tf-ion-ios-search-strong"></i> Search</a>
					<ul class="dropdown-menu search-dropdown">
					  <li><form action="post" onsubmit="search()"><input type="search" id="searchbox" class="form-control" placeholder="Search..."></form></li>
					</ul>
				  </li><!-- / Search -->
	
				  <!--Search function-->
	    <script>
		        function search() 
		        {
		            event.preventDefault();
		            var gotsearch = false;
		            var item=["bicycle","guitar","ultramen","toy car","children car","cubebox","dinosour","barbie doll","fishing game","pistol","transformer","scooter"]
		            var str=document.getElementById("searchbox").value.toLowerCase();
		            for(var i=0; i<12;i++)
		            {
		                if(str===item[i]){
		                    gotsearch=true;
		                    location.replace("product"+(i+1)+".html");}
		            }
		            if(gotsearch==false)
		                location.replace("404.html");
		        }     
		    </script>
				
  
			  </ul><!-- / .nav .navbar-nav .navbar-right -->
			  </div>
		  </div>
	  </div>
  </section><!-- End Top Header Bar -->
  
  
  <!-- Main Menu Section -->
  <section class="menu">
	  <nav class="navbar navigation">
		  <div class="container">
			<div class="navbar-header">
				<h2 class="menu-title">Main Menu</h2>
			  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			  </button>
  
			</div><!-- / .navbar-header -->
  
			<!-- Navbar Links -->
			<div id="navbar" class="navbar-collapse collapse text-center">
			  <ul class="nav navbar-nav">
  
				<!-- Home -->
				<li class="dropdown ">
				  <a href="index.html">Home</a>
				</li><!-- / Home -->
  
  
				<!-- Elements -->
				<li class="dropdown dropdown-slide">
				  <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="350" role="button" aria-haspopup="true" aria-expanded="false">Shop <span class="tf-ion-ios-arrow-down"></span></a>
				  <div class="dropdown-menu">
					<div class="row">
  
					  <!-- Basic -->
					  <div class="col-lg-6 col-md-6 mb-sm-3">
						  <ul>
							  <li class="dropdown-header">Pages</li>
							  <li role="separator" class="divider"></li>
							  <li><a href="shop.html">Shop</a></li>
							  <li><a href="checkout.html">Checkout</a></li>
							  <li><a href="cart.html">Cart</a></li>
						  </ul>
					  </div>
  
  
					</div><!-- / .row -->
				  </div><!-- / .dropdown-menu -->
				</li><!-- / Elements -->
  
  
				<!-- Pages -->
				<li class="dropdown full-width dropdown-slide">
				  <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="350" role="button" aria-haspopup="true" aria-expanded="false">Pages <span class="tf-ion-ios-arrow-down"></span></a>
				  <div class="dropdown-menu">
						<div class="row">
  
						  <!-- Introduction -->
						  <div class="col-sm-3 col-xs-12">
							  <ul>
								  <li class="dropdown-header">Introduction</li>
								  <li role="separator" class="divider"></li>
								  <li><a href="about.html">About Us</a></li>
								  <li><a href="faq.html">FAQ</a></li>
							  </ul>
						  </div>
  
						 <!-- Contact -->
						 <div class="col-sm-3 col-xs-12">
		                	<ul>
								<li class="dropdown-header">Dashboard</li>
								<li role="separator" class="divider"></li>
								<li><a href="order.html">Orders</a></li>
								<li><a href="profile.htm">Profile Details</a></li>
		                	</ul>
		                </div>

		                <!-- Utility -->
		                <div class="col-sm-3 col-xs-12">
		                	<ul>
								<li class="dropdown-header">Utility</li>
								<li role="separator" class="divider"></li>
								<li><a href="login.htm">Login Page</a></li>
								<li><a href="sign-up.htm">Signin Page</a></li>
		                	</ul>
		                </div>
  
						  <!-- Mega Menu -->
						  <div class="col-sm-3 col-xs-12">
							  <a href="shop.html">
								  <img class="img-responsive" src="images/logo.jpg" alt="menu image" />
							  </a>
						  </div>
						</div><!-- / .row -->
				  </div><!-- / .dropdown-menu -->
				</li><!-- / Pages -->
  
			  </ul><!-- / .nav .navbar-nav -->
  
				</div><!--/.navbar-collapse -->
		  </div><!-- / .container -->
	  </nav>
  </section>
<section class="page-header">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="content">
					<h1 class="page-name">Checkout</h1>
					<ol class="breadcrumb">
						<li><a href="#">Home</a></li>
						<li class="active">checkout</li>
					</ol>
				</div>
			</div>
		</div>
	</div>
</section>
<div class="page-wrapper">
   <div class="checkout shopping">
      <div class="container">
         <div class="row">
            <div class="col-md-8">
				<div class="block billing-details">
					<h4 class="widget-title">Billing Details</h4>
					<form class="checkout-form" onsubmit="checkout_confirm()">
					   <div class="form-group">
						  <label for="user_address">Address</label>
						  <input type="text" class="form-control" id="user_address" placeholder="" required>
					   </div>
					   <div class="checkout-country-code clearfix">
						  <div class="form-group">
							 <label for="user_post_code">Zip Code</label>
							 <input type="text" class="form-control" id="user_post_code" name="zipcode" value="" required>
						  </div>
						  <div class="form-group" >
							 <label for="user_city">City</label>
							 <input type="text" class="form-control" id="user_city" name="city" value="" required>
						  </div>
					   </div>
					   <div class="form-group">
						  <label for="user_state">State</label>
						  <input type="text" class="form-control" id="user_state" placeholder="" required>
					   </div>
					   <div class="block">
						<h4 class="widget-title">Payment Method</h4>
						<div id="paypal-button-container"></div>
						<input id="confirm-button" type="submit" value="Confirm" class="btn btn-main mt-20"></input>
					 </div>
					</form>
				 </div>
               
            </div>
            <div class="col-md-4">
               <div class="product-checkout-details">
                  <div class="block">
                     <h4 class="widget-title">Order Summary</h4>
                     <div id="order">
                        <table id="orderSummary"> </table>
						<div id="subtotal"> </div>
                      </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
<!--check the cart empty or not ,sum up the item price-->
<script>
	var toylist = new Array(12);
    var item_name = ["Chilren Bicycle","Guitar","Ultramen","Toy Car","Children Car","Magic Cube 3x3","Dinosour","Barbie Doll","Fishing Game","Gun","Transformer","Scooter"];
	var picture_name = ["bicycle","guitar","ultramen","car","Childcar","cube","dino","doll","fish","gun1","robot","scooter"];
	var price=[50,70,15,30,45,10,12,25,28,16,23,48];
	var cartempty = true; // boolean to check cart empty or not
	var total = 0;
         
         
      if ("Item" in localStorage) {
            cartempty = false;//if local storage not found which mean cart is empty
            toylist = JSON.parse(localStorage.getItem("Item"));//get JSON array from local storage (items in cart) 
			
            for(var i = 0; i < toylist.length; i++)
	         {
		         if(toylist[i]==null)
		            continue;

	            var table = document.getElementById("orderSummary");
	            var row = table.insertRow(-1);
	            var cell1 = row.insertCell(0);
	            var cell2 = row.insertCell(1);
	            var cell3 = row.insertCell(2);
	            var cell4 = row.insertCell(3);
	            cell1.innerHTML = "<a href='product"+(i+1)+".html'>"+item_name[i]+"</a>";//display product name and button lead to following page
	            if (i == 0) { //because item1 in png format I hardcode seperate out
			         cell2.innerHTML = "<a href='product1.html'><img src='images/Toys/bicycle.png' width='100' height='100' alt='bicycle'/></a>";
		         }
		         else { //load the array to display the picture
			         cell2.innerHTML = "<a href='product"+(i+1)+".html'><img src='images/Toys/"+picture_name[i]+".jpg' width='100' height='100' alt='"+picture_name[i]+"'/></a>";
		         }
			   
		         //get the price from local storage
		         cell3.innerHTML = parseInt(toylist[i].Total)/parseInt(price[i]);
		         cell4.innerHTML = "USD "+ parseInt(toylist[i].Total);

		         //Sum all the price
		         total+= parseInt(toylist[i].Total);
	         }
      }
      else
	  {
         cartempty = true;
		 document.getElementById("confirm-button").style.visibility = "hidden";
	  }
	if(cartempty==true)
	{ //if the cart is empty
	   document.getElementById("order").innerHTML = "<h2 style='text-shadow:-4px 4px 6px dimgrey'>Your cart is empty.</h2><br><a href='shop.html'><h1 style='background-color:black;color:white;border-style:ridge;text-align:center'>Shop Now</h1></a>";
	}
	else{ //add to first row of the table orderSummary
	   var row = table.insertRow(0);
	   var cell1 = row.insertCell(0);
	   var cell2 = row.insertCell(1);
	   var cell3 = row.insertCell(2);
	   var cell4 = row.insertCell(3);
	   cell1.innerHTML = "<b>Item</b>";
	   cell2.innerHTML = "<b>Picture</b>";
	   cell3.innerHTML = "<b>Quantity</b>";
	   cell4.innerHTML = "<b>Price</b>";

	   //else show the total
	   document.getElementById("subtotal").innerHTML = "<table><tr><td>Subtotal :</td>"+"<td><h1><strong>USD "+String(total)+"</strong></h1></td></tr></table>";
	}


//<!--clear the cart and display in order list when the checkout is confirm-->

	function checkout_confirm()//when user click confirm button
    {
		event.preventDefault();
		var order = [];
		//get the address from user input
		var address = document.getElementById("user_address").value+", "+document.getElementById("user_post_code").value+", "+document.getElementById("user_city").value+", "+document.getElementById("user_state").value+".";
		var o_date = new Date();//get the current date
       	var month=["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
         for(var i=0;i<12;i++)
       	 {
         	if(o_date.getMonth()==i)
            	var d_month=month[i];
       	 }
		//finalize the date format
       	var order_date = String(o_date.getDate()).padStart(2, '0')+" "+d_month+","+o_date.getFullYear();
		//get how much item in the cart
	   	var items = document.getElementById("orderSummary").rows.length-1;

		//date,address,item quantity,total price store in Javascript object format
		var JSONorder = {"date":order_date,"quantity":items,"total":total,"address":address};
		//change to JSON format
		JSONorder=JSON.stringify(JSONorder);
         if ("Order" in localStorage){//if got previous order append to it
            order = JSON.parse(localStorage.getItem("Order"));
            order.push(JSONorder);
            localStorage.setItem("Order", JSON.stringify(order));
            localStorage.removeItem("Item");//clear the cart
			location.replace("confirmation.html");
         }
         else // else create a new one
         {
           order.push(JSONorder);
           localStorage.setItem("Order", JSON.stringify(order));
           localStorage.removeItem("Item");//clear the cart
		   location.replace("confirmation.html");
         }    
    }
</script>

<footer class="footer section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<ul class="footer-menu">
					
					<li>
						<a href="tandc.html">TERMS OF SERVICE</a>
					</li>
					<li>
						<a href="privacy.html">PRIVACY POLICY</a>
					</li>
				</ul>
				<p class="copyright-text">Powered by Bootstrap</p>
			</div>
		</div>
	</div>
</footer>
    <!-- 
    Essential Scripts
    =====================================-->
    
    <!-- Main jQuery -->
    <script src="plugins/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap 3.1 -->
    <script src="plugins/bootstrap/js/bootstrap.min.js"></script>
    <!-- Bootstrap Touchpin -->
    <script src="plugins/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>
    <!-- Instagram Feed Js -->
    <script src="plugins/instafeed-js/instafeed.min.js"></script>
    <!-- Video Lightbox Plugin -->
    <script src="plugins/ekko-lightbox/dist/ekko-lightbox.min.js"></script>
    <!-- Count Down Js -->
    <script src="plugins/SyoTimer/build/jquery.syotimer.min.js"></script>
    
    <!-- Revolution Slider -->
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/jquery.themepunch.tools.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/jquery.themepunch.revolution.min.js"></script>
    
    <!-- Revolution Slider -->
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.actions.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.carousel.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.kenburn.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.layeranimation.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.migration.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.navigation.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.parallax.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.slideanims.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.video.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/revolution/js/extensions/revolution.extension.video.min.js"></script>
    <script type="text/javascript" src="plugins/revolution-slider/assets/warning.js"></script>  


<!--Paypal script-->
<script>
	paypal.Button.render({
		env: 'production', // sandbox | production
		// PayPal Client IDs - replace with your own
		// Create a PayPal app: https://developer.paypal.com/developer/applications/create
		client: {
			sandbox:    'AZDxjDScFpQtjWTOUtWKbyN_bDt4OgqaF4eYXlewfBP4-8aqX3PiV8e1GWU6liB2CUXlkA59kJXE7M6R',
			production: 'ASILLe-cwR4ETHBEnGIOB0_gvJSJI78GNeWVloT7n3OoaSQvbpnVN0F3TcYv0fGeD3_zV6D4_OOV--FT'
		},
		// Show the buyer a 'Pay Now' button in the checkout flow
		commit: true,
		// payment() is called when the button is clicked
		payment: function(data, actions) {
			// Make a call to the REST api to create the payment
			return actions.payment.create({
				payment: {
					transactions: [
						{
							amount: { total: total, currency: 'USD' }
						}
					]
				}
			});
		},
		// onAuthorize() is called when the buyer approves the payment
		onAuthorize: function(data, actions) {
			// Make a call to the REST api to execute the payment
			return actions.payment.execute().then(function() {
				window.alert('Payment Complete!');
			});
		}
	}, '#paypal-button-container');
</script>

<!--Start of Tawk.to Script-->
<script type="text/javascript">
	var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
	(function(){
	var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
	s1.async=true;
	s1.src='https://embed.tawk.to/5f48a308cc6a6a5947af972f/default';
	s1.charset='UTF-8';
	s1.setAttribute('crossorigin','*');
	s0.parentNode.insertBefore(s1,s0);
	})();
</script>
<!--End of Tawk.to Script-->

    <!-- Google Mapl -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCC72vZw-6tGqFyRhhg5CkF2fqfILn2Tsw"></script>
  <script type="text/javascript" src="plugins/google-map/gmap.js"></script>

    <!-- Main Js File -->
	<script src="js/script.js"></script>
	<!-- TODO Register the service worker -->
	<script>
		if ('serviceWorker' in navigator) {
		  window.addEventListener('load', function () {
			navigator.serviceWorker.register('sw.js')
			  .then(reg => {
				console.log('Service worker registered! 😎', reg);
			  })
			  .catch(err => {
				console.log('😥 Service worker registration failed: ', err);
			  });
		  });
		}
	  </script>


  </body>
  </html>